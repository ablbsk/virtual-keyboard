(()=>{"use strict";const e={row1:[{id:"Backquote",type:"symbol",value:{en:["`","~"],ru:["ё","Ё"]},capslock:{en:!1,ru:!0}},{id:"Digit1",type:"symbol",value:{en:["1","!"],ru:["1","!"]},capslock:{en:!1,ru:!1}},{id:"Digit2",type:"symbol",value:{en:["2","@"],ru:["2",'"']},capslock:{en:!1,ru:!1}},{id:"Digit3",type:"symbol",value:{en:["3","#"],ru:["3","№"]},capslock:{en:!1,ru:!1}},{id:"Digit4",type:"symbol",value:{en:["4","$"],ru:["4",";"]},capslock:{en:!1,ru:!1}},{id:"Digit5",type:"symbol",value:{en:["5","%"],ru:["5","%"]},capslock:{en:!1,ru:!1}},{id:"Digit6",type:"symbol",value:{en:["6","^"],ru:["6","?"]},capslock:{en:!1,ru:!1}},{id:"Digit7",type:"symbol",value:{en:["7","&"],ru:["7","?"]},capslock:{en:!1,ru:!1}},{id:"Digit8",type:"symbol",value:{en:["8","*"],ru:["8","*"]},capslock:{en:!1,ru:!1}},{id:"Digit9",type:"symbol",value:{en:["9","("],ru:["9","("]},capslock:{en:!1,ru:!1}},{id:"Digit0",type:"symbol",value:{en:["0",")"],ru:["0",")"]},capslock:{en:!1,ru:!1}},{id:"Minus",type:"symbol",value:{en:["-","_"],ru:["-","_"]},capslock:{en:!1,ru:!1}},{id:"Equal",type:"symbol",value:{en:["=","+"],ru:["=","+"]},capslock:{en:!1,ru:!1}},{id:"Backspace",type:"special",value:"Backspace"}],row2:[{id:"Tab",type:"special",value:"Tab"},{id:"KeyQ",type:"symbol",value:{en:["q","Q"],ru:["й","Й"]},capslock:{en:!0,ru:!0}},{id:"KeyW",type:"symbol",value:{en:["w","W"],ru:["ц","Ц"]},capslock:{en:!0,ru:!0}},{id:"KeyE",type:"symbol",value:{en:["e","E"],ru:["у","У"]},capslock:{en:!0,ru:!0}},{id:"KeyR",type:"symbol",value:{en:["r","R"],ru:["к","К"]},capslock:{en:!0,ru:!0}},{id:"KeyT",type:"symbol",value:{en:["t","T"],ru:["е","Е"]},capslock:{en:!0,ru:!0}},{id:"KeyY",type:"symbol",value:{en:["y","Y"],ru:["н","Н"]},capslock:{en:!0,ru:!0}},{id:"KeyU",type:"symbol",value:{en:["u","U"],ru:["г","Г"]},capslock:{en:!0,ru:!0}},{id:"KeyI",type:"symbol",value:{en:["i","I"],ru:["ш","Ш"]},capslock:{en:!0,ru:!0}},{id:"KeyO",type:"symbol",value:{en:["o","O"],ru:["щ","Щ"]},capslock:{en:!0,ru:!0}},{id:"KeyP",type:"symbol",value:{en:["p","P"],ru:["з","З"]},capslock:{en:!0,ru:!0}},{id:"BracketLeft",type:"symbol",value:{en:["[","{"],ru:["х","Х"]},capslock:{en:!1,ru:!0}},{id:"BracketRight",type:"symbol",value:{en:["]","}"],ru:["ъ","Ъ"]},capslock:{en:!1,ru:!0}},{id:"Delete",type:"special",value:"Delete"}],row3:[{id:"CapsLock",type:"special",value:"CapsLock"},{id:"KeyA",type:"symbol",value:{en:["a","A"],ru:["ф","Ф"]},capslock:{en:!0,ru:!0}},{id:"KeyS",type:"symbol",value:{en:["s","S"],ru:["ы","Ы"]},capslock:{en:!0,ru:!0}},{id:"KeyD",type:"symbol",value:{en:["d","D"],ru:["в","В"]},capslock:{en:!0,ru:!0}},{id:"KeyF",type:"symbol",value:{en:["f","F"],ru:["а","А"]},capslock:{en:!0,ru:!0}},{id:"KeyG",type:"symbol",value:{en:["g","G"],ru:["п","П"]},capslock:{en:!0,ru:!0}},{id:"KeyH",type:"symbol",value:{en:["h","H"],ru:["р","Р"]},capslock:{en:!0,ru:!0}},{id:"KeyJ",type:"symbol",value:{en:["j","J"],ru:["о","О"]},capslock:{en:!0,ru:!0}},{id:"KeyK",type:"symbol",value:{en:["k","K"],ru:["л","Л"]},capslock:{en:!0,ru:!0}},{id:"KeyL",type:"symbol",value:{en:["l","L"],ru:["д","Д"]},capslock:{en:!0,ru:!0}},{id:"Semicolon",type:"symbol",value:{en:[";",":"],ru:["ж","Ж"]},capslock:{en:!1,ru:!0}},{id:"Quote",type:"symbol",value:{en:["'",'"'],ru:["э","Э"]},capslock:{en:!1,ru:!0}},{id:"Enter",type:"special",value:"Enter"}],row4:[{id:"ShiftLeft",type:"special",value:"Shift"},{id:"Backslash",type:"symbol",value:{en:["\\","|"],ru:["\\","/"]},capslock:{en:!1,ru:!1}},{id:"KeyZ",type:"symbol",value:{en:["z","Z"],ru:["я","Я"]},capslock:{en:!0,ru:!0}},{id:"KeyX",type:"symbol",value:{en:["x","X"],ru:["ч","Ч"]},capslock:{en:!0,ru:!0}},{id:"KeyC",type:"symbol",value:{en:["c","C"],ru:["с","С"]},capslock:{en:!0,ru:!0}},{id:"KeyV",type:"symbol",value:{en:["v","V"],ru:["м","М"]},capslock:{en:!0,ru:!0}},{id:"KeyB",type:"symbol",value:{en:["b","B"],ru:["и","И"]},capslock:{en:!0,ru:!0}},{id:"KeyN",type:"symbol",value:{en:["n","N"],ru:["т","Т"]},capslock:{en:!0,ru:!0}},{id:"KeyM",type:"symbol",value:{en:["m","M"],ru:["ь","Ь"]},capslock:{en:!0,ru:!0}},{id:"Comma",type:"symbol",value:{en:[",",","],ru:["б","Б"]},capslock:{en:!1,ru:!0}},{id:"Period",type:"symbol",value:{en:[".","."],ru:["ю","Ю"]},capslock:{en:!1,ru:!0}},{id:"Slash",type:"symbol",value:{en:["/","?"],ru:[".",","]},capslock:{en:!1,ru:!1}},{id:"ArrowUp",type:"arrow",value:"▲"},{id:"ShiftRight",type:"special",value:"Shift"}],row5:[{id:"ControlLeft",type:"special",value:"Ctrl"},{id:"Win",type:"special",value:"Win"},{id:"AltLeft",type:"special",value:"Alt"},{id:"Space",type:"symbol",value:" "},{id:"AltRight",type:"special",value:"Alt"},{id:"ControlRight",type:"special",value:"Ctrl"},{id:"ArrowLeft",type:"arrow",value:"◄"},{id:"ArrowDown",type:"arrow",value:"▼"},{id:"ArrowRight",type:"arrow",value:"►"}]};let l=[0,0],t=!1;const a=(e,t)=>{let{value:a}=e,[n,i]=l,p="";return[p,n,i]=n===i?i===a.length?s(a,t):c(a,t,n,i):i===a.length?r(a,t,n,i):u(a,t,n,i),o(e,n,i),p},n=(e,a)=>{let{value:n}=e,[p,y]=l,d="";switch(a){case"Tab":[d,p,y]=p===y?y===n.length?s(n,"\t"):c(n,"\t",p,y):y===n.length?r(n,"\t",p,y):u(n,"\t",p,y);break;case"Enter":[d,p,y]=p===y?y===n.length?s(n,"\n"):c(n,"\n",p,y):y===n.length?r(n,"\n",p,y):u(n,"\n",p,y);break;case"Backspace":p===y?y===n.length?(d=n.slice(0,n.length-1),p=y=d.length):(d=n.slice(0,p-1)+n.slice(y),p=y-=1):y===n.length?(d=n.slice(0,p),p=y=d.length):(d=n.slice(0,p)+n.slice(y),y=p);break;case"Delete":p===y?y===n.length?(d=n,p=y=n.length):(d=n.slice(0,p)+n.slice(y+1),p=y):y===n.length?(d=n.slice(0,p),p=y=d.length):(d=n.slice(0,p)+n.slice(y),y=p);break;case"CapsLock":return t=!t,i(),n;case"ArrowUp":return n+"▲";case"ArrowRight":return n+"►";case"ArrowDown":return n+"▼";case"ArrowLeft":return n+"◄";default:return n}return o(e,p,y),d},s=(e,l)=>{let t=e+l;return[t,t.length,t.length]},c=(e,l,t,a)=>[e.slice(0,t)+l+e.slice(a),t=a+=1,a],r=(e,l,t,a)=>[e.slice(0,t)+e.slice(a)+l,e.length,e.length],u=(e,l,t,a)=>{let n=e.slice(0,t)+l+e.slice(a,e.length);return a=t+=1,[n,t,a]},o=(e,l,t)=>setTimeout((()=>e.setSelectionRange(l,t))),i=()=>{const l=document.getElementsByClassName("key");Array.from(l).map((l=>{const t=l.parentElement.classList[1],a=e[t].find((e=>e.id===l.id));l.innerText=p(a)}))},p=({id:e,type:l,capslock:a,value:n})=>{const s=t?1:0;return"symbol"===l&&"Space"!==e?a.en?n.en[s]:n.en[0]:"object"==typeof n?n.en[s]:n.toUpperCase()};window.onload=()=>{(()=>{const e=document.createElement("main");document.body.appendChild(e);const l=document.createElement("h1");l.innerHTML="Virtual Keyboard (Windows)",e.appendChild(l);const t=document.createElement("p");t.innerHTML="Для переключения языка комбинация: Ctrl + Shift (Слево)",e.appendChild(t);const a=document.createElement("div");a.classList.add("display"),e.appendChild(a);const n=document.createElement("textarea");n.classList.add("screen"),a.appendChild(n);const s=document.createElement("div");s.classList.add("keyboard"),e.appendChild(s)})(),((l=Object.keys(e))=>{l.map((t=>{const a=document.createElement("div");a.classList.add("keyboard__row",t),((e,l)=>{l.map((l=>{const t=document.createElement("span");t.id=l.id,t.classList.add("key","key__"+l.type),t.innerHTML="object"==typeof l.value?l.value.en[0]:l.value.toUpperCase(),e.appendChild(t)}))})(a,e[t]),l[l.length-1]===t&&(e=>{const l=document.createElement("span");l.id="Plug",e.appendChild(l)})(a),document.getElementsByClassName("keyboard")[0].appendChild(a)}))})();const t=document.getElementsByClassName("keyboard")[0],s=document.getElementsByClassName("screen")[0];s.focus(),document.addEventListener("keydown",(e=>{l=[e.target.selectionStart,e.target.selectionEnd],(e=>{e.preventDefault();const{key:l}=e,t=document.getElementsByClassName("screen")[0];t.value=l.length<2?a(t,l):n(t,l)})(e),s.focus(),console.log("keydown: ",l)})),s.addEventListener("click",(e=>{e.stopPropagation(),l=[e.target.selectionStart,e.target.selectionEnd],console.log("click: ",l)})),t.addEventListener("click",(t=>{t.stopPropagation(),l=[s.selectionStart,s.selectionEnd],(l=>{l.preventDefault();const t=document.getElementsByClassName("screen")[0],s=e=>e.find((e=>l.target.id===e.id)),c=Object.keys(e).filter((l=>s(e[l])))[0];if(!c)return t;const r=s(e[c]);"arrow"===r.type?t.value=n(t,r.id):t.value="symbol"!==r.type?n(t,r.value):a(t,p(r))})(t),s.focus()}))}})();